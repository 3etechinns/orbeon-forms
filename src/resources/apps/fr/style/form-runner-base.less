/**
 * Copyright (C) 2010 Orbeon, Inc.
 *
 * This program is free software; you can redistribute it and/or modify it under the terms of the
 * GNU Lesser General Public License as published by the Free Software Foundation; either version
 * 2.1 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details.
 *
 * The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
 */

// NOTE: IE em factor: 0.9759

@import "form-runner-common";

@border: #DDDDEE;

.fr-logo img {
    float: left;
    padding-top: 7px;
    margin-right: 10px;
}

.fr-status-icons {
  float: right;
  padding-top: 7px;
  img { margin-left: 3px; }
}

.fr-body {
    display: block;
    h2 { margin-top: 0; }
}

body { padding-top: 40px } // if using navbar-fixed-top

/* ***** Utilities ************************************************************************************************** */
.fr-clear { clear: both }

/* ***** Portlet reset *********************************************************************************************** */

// rom YUI font.css, but applied to portlet body only
.orbeon-portlet-body {
    font: 13px/1.231 arial,helvetica,clean,sans-serif;
	// for IE6/7
	*font-size: small;
	// for IE Quirks Mode
	*font: x-small;
}

/* ***** XForms Controls ******************************************************************************************** */

// Make sure disabled items take precedence over display: block on other classes
#fr-view {
    .xforms-disabled { display: none }
    .xforms-template { display: none }
    .xforms-repeat-template { display: none }
    span.xforms-alert-inactive { display: none }
    .xforms-disabled .xforms-label { display: none }
    .xforms-case-deselected { display: none }
    .xforms-case-deselected .xforms-label { display: none }
    .fr-hidden { display: none }
}

.xforms-noscript {
    // NOTE: In noscript mode, help appears last in a control for accessibility reasons
    .xforms-help-image {
        display: block;
        margin: 0 0 0 .5em;
    }

    .fr-section-title .xforms-help-image {
        display: inline;
    }

    // Noscript help section
    .xforms-help-panel {
        display: block;
        width: auto;
        padding: 0 1em;

        .xforms-help-group { margin: 0 0 .5em }
        .xforms-label { display: inline }
        .xforms-help { display: inline }
        .xforms-help-anchor { display: none }
        .xforms-help-image { display: none }
    }

    .fr-help-back { margin-left: .5em }

    .fr-mode-view .xforms-help-image, .fr-mode-pdf .xforms-help-image, .fr-mode-email .xforms-help-image { display: none }
}

// Display alerts under each control
.xforms-alert-active {
    display: none;
    margin-top: .2em;
    margin-left: 0;// used to have margin here but with new colors no margin seems better
    height: auto;
    width: auto;// width: 100%;
    padding: 1px;
    font-size: inherit;// override xforms.css
    text-indent: 0;// override xforms.css
    background-image: none;// override xforms.css
    white-space: normal;// override xforms.css to allow for multiline alert messages
}

.xforms-alert-active-visited {
    display: block;
    clear: both;
}

.xforms-alert-inactive {
    display: none;// Otherwise inactive alerts take vertical space because of defaults in xforms.css
}

// Display hints under each control
.xforms-hint {
    display: block;
    margin-top: .2em;
    margin-left: 0;// used to have margin here but with new colors no margin seems better
    width: 100%;
}

// Make sure text in trigger does not wrap (leads to non-native widget being used on Firefox)
.xforms-trigger button, .xforms-trigger input { white-space: nowrap }

// Make the button look like a link for noscript mode
// TODO: add *zoom: 1 for IE?
.xforms-trigger-appearance-xxforms-minimal button,
    .xforms-trigger-appearance-xxforms-minimal input {
    display: -moz-inline-box; display: inline-block;
    text-decoration: underline;
    font-size: inherit;
    padding: 0;
    /*vertical-align: middle;*/ // removing this for better alignment of top links/buttons
}

// But for boolean inputs, no background and border (for IE)
.xforms-type-boolean input { background: none; border: none }

// Upload control information
.xforms-upload-info {
    display: block;
    width: 100%;
    padding: 2px 2px 2px 18px;
    background: url( images/silk/attach.png ) no-repeat left center;
    .box-sizing(border-box);
}

.xforms-upload-mediatype, .xforms-upload-size { padding-left: 1em }
.xforms-upload-remove { vertical-align: top }

// No default highlight for repeated items
.xforms-repeat-selected-item-1 { background-color: transparent }
.xforms-repeat-selected-item-2 { background-color: transparent }
.xforms-repeat-selected-item-3 { background-color: transparent }
.xforms-repeat-selected-item-4 { background-color: transparent }

.xforms-help-panel-message {
    padding: .5em 0;
    margin-bottom: .5em;
    border-bottom: 2px solid @border;
}

/* ***** General Layout ********************************************************************************************* */

// Language and mode selectors
.fr-goto-content, .fr-language-choice, .fr-noscript-choice { margin-right: 1em }

.fr-goto-content .xforms-trigger-appearance-xxforms-minimal,
    .fr-language-choice .xforms-trigger-appearance-xxforms-minimal,
    .fr-noscript-choice .xforms-trigger-appearance-xxforms-minimal { *font-size: 100% }// IE 6 HACK to fix the font size
.fr-goto-content .xforms-label, .fr-language-choice .xforms-label, .fr-noscript-choice .xforms-label { display: inline; margin-right: .5em }

// Status icons
.fr-status-icons { margin-bottom: .5em; float: left }
.fr-status-icons img { margin-right: .5em }

// Enable noscript icon when in noscript mode
.fr-noscript-icon { display: none }
.xforms-noscript .fr-noscript-icon { display: inline }

// Messages
.fr-message-success {
    display: block;
    .box-sizing(border-box);
    width: 100%;
}
.fr-unsaved-data { color: red }

// Error summary
.xbl-fr-error-summary {
    .fr-error-summary-body { padding: 0 10px }
    .fr-error-title { margin: 0; .box-sizing(border-box); width: 100%; *width: 97.5% }
    .fr-error-list { padding-top: 10px; margin-top: 0  }
}

// Explanation message if present
.fr-explanation { padding: 10px }

// Button bar

.fr-buttons {
    float: right;
    margin-bottom: 1em;

    /* Space between the image and the text in a button, only for the buttons bar
       (not other buttons in the form which might contain just an image) */
    .xforms-trigger button img { margin-right: 10px }

    .xforms-trigger button, .xforms-trigger input {
        width: 9.5em; *width: 9em
    }

    // Special sizing for expand/collapse/refresh buttons
    #fr-collapse-all-button .xforms-trigger button, #fr-expand-all-button .xforms-trigger button, #fr-refresh-button .xforms-trigger button {
        min-width: 2em;
        width: 2em;
        padding: 0;
    }

    // Special sizing for new expand/collapse/refresh buttons
    #fr-collapse-all-button.xforms-trigger button, #fr-expand-all-button.xforms-trigger button, #fr-refresh-button.xforms-trigger button {
        min-width: 2em;
        width: 2em;
        padding: 3px;
    }

    #fr-collapse-all-button img, #fr-expand-all-button img, #fr-refresh-button img {
        margin-right: 0
    }
}

/* ***** Repeats **************************************************************************************************** */

// Repeats: shows as table (1 line per iteration; labels used as header of table)
.fr-repeat-table {

    // Don't show label, help, hint for controls inside a repeat-table which repeats over a single row only (they are shown in the column header)
    &.fr-repeat-single-row {
        td {
            .xforms-label { display: none }
            .xforms-help-image { display: none }
            .xforms-help { display: none }
            .xforms-hint { display: none }
        }
    }

    // But if there is a nested table, show those in the label in the column header of that table
    tr th {
        .xforms-label { display: block }         // Label in repeat table header is block so yellow background in FB takes the whole width
        .xforms-help-image { margin-top: 0 }
    }

    .fr-repeat-column-trigger {
        width: 16px;
        text-align: center;

        img { margin: 0; display: block }
        span img { *margin-left: 0px } // IE buttons depress; is there a way to remove their 1px 3px padding?
        button { display: block; margin: auto }
    }
}

/* ***** Dialogs **************************************************************************************************** */

// Dialogs
.xforms-dialog {
    width: 400px;

    ol { padding-left: 3em }
    li { list-style-type: decimal }// overrides YUI reset so numbers in enumeration do show
    .bd p { margin: .5em 0 .5em 0 }
    .hd { background-color: #666699 }
    .bd { margin: 0 .5em .5em .5em }
    .fr-dialog-icon { float: left; margin-right: 2em; margin-left: 1em; padding-bottom: 1em }
    .fr-dialog-buttons { text-align: right; padding-right: .5em; padding-top: .5em; padding-bottom: .5em; margin-top: .5em; border-top: 2px solid @border; clear: both }
}

#fr-submission-result-dialog { width: 800px }

/* ***** Sections *************************************************************************************************** */

// Sections
.fr-section-container {
    display: block; clear: both;

    .fr-section-title {
        .xforms-help-image {
            float: left;                        // Help on the same line as section title in display: block
            padding-top: 12px;                  // To make it vertically centered, with a linge height of 40px and image height of 16px: (40-16)/2 = 12px
            padding-right: 10px;                // Space between help icon and section title
        }
    }

    p { margin-top: 1em }
    .fr-section-open-close img { margin-right: 0 }
    .fr-section-open-close {
        // Padding is designed to make the <a> box around the section open/close images a square
        padding: 0 7px 0 7px;
    }

    .fr-section-content {
        display: block;
        padding-left: 22px;                     // To be aligned with the start of the text of the titles
        padding-right: 22px;                    // To have the same margin on both side, especially visible with tables
        padding-top: 22px;                      // At the top/bottom of a section, same as padding left/right for sense of alignment
        padding-bottom: 22px;
    }
}


.fr-captcha {
    display: block;                             // By default captcha is inline
    margin-left: 22px;                          // Margin left to be aligned with fr-section-content
    margin-top: 1.5em; margin-bottom: 1em;      // Spacing before and after
}

/* ***** Grids ****************************************************************************************************** */

.fr-grid-td .fr-grid-content .fr-hidden { display: none } // for users of .fr-hidden without #fr-view

.fr-grid {

    select,
    textarea,
    input[type="text"],             // Like Boostrap, use all the specific types to exclude checkbox/radio
    input[type="password"],
    input[type="datetime"],
    input[type="datetime-local"],
    input[type="date"],
    input[type="month"],
    input[type="time"],
    input[type="week"],
    input[type="number"],
    input[type="email"],
    input[type="url"],
    input[type="search"],
    input[type="tel"],
    input[type="color"],
    .uneditable-input {
        width: 100%;
        *padding: 0;                // IE7 doesn't support box-sizing, so undo Bootstrap padding, so width: 100% doesn't get the input doesn't overflow its container
    }

    table-layout: fixed;
    width: 100%;

    .xforms-textarea textarea {
        width: 100%;                // It's a reasonable default for textareas to be very wide
        height: 70px;
    }

    thead tr th { text-align: left }
    tbody tr td { vertical-align: top }

    // Override previous rule for autocomplete input, which can't be sized with width: 100%
    .xbl-fr-autocomplete .xforms-input input { width: 140px }

    // Make HTML editor shorter by default
    .xforms-mediatype-text-html textarea { height: 10.1em } // NOTE: with Firefox, 10em makes bottom line disappear

    // Set this again as default is 100% above
    // NOTE: This doesn't work well with IE 6/7
    .xforms-input input {
        &.xforms-type-date, &.xforms-type-time {
            width: 7.5em;
        }
    }

    .xforms-help-image {
        float: left;
        padding-top: (@baseLineHeight - 16)/2;      // Vertically center help image on first line
        padding-right: 3px;
    }

    .xforms-label {
        margin-bottom: .5em;                        // Insert some space between the label / help and the control (we add spacing below the label rather
                                                    // than above the control to make the CSS more generally applicable to XBL components)
        display: block;                             // Content after the label to show on a "new line"
        overflow: hidden;                           // So the block area doesn't extend below the floated help, when there is one. Also see http://bit.ly/ruAKSU
        zoom: 1;                                    // For the overflow: hidden to have an effect on IE6
    }

    // Cell content
    .fr-grid-content {
        padding: 4px;                               // Add some space around control
        *padding-right: 6px;                        // To help IE move back controls within .fr-grid-content
    }
}

.fr-repeat-table {
    .fr-grid-content {
        // No top/bottom padding in repeated grid cells
        padding-top: 0;
        padding-bottom: 0;
    }
}

.fr-grid {

    // But for boolean inputs, don't size (for IE)
    .xforms-type-boolean input {
        width: auto;
    }

    .xforms-upload input { width: auto } // The upload field responds to 100% width on IE, which gives strange result
        .xforms-select1-appearance-compact select, .xforms-select-appearance-compact select { height: 6em }

    // Image output
    .xforms-mediatype-image { width: 100%; overflow: auto; display: block }
    .xforms-mediatype-image { *padding-bottom: 17px; *overflow-y: hidden }// IE HACK
    .xforms-mediatype-image img { display: block }

    //  Buttons
    .fr-grid-content {
        .xforms-trigger button, .xforms-trigger input { margin-top: 1.72em } // hand-tuned so it appears at about the same pos as input fields
        .xforms-trigger button, .yui-button .xforms-trigger input { margin-top: 0 } // except YUI buttons don't appear right with top margin!
    }

    // Cell widths
    .fr-grid-td {
        width: auto; vertical-align: top;
        /*overflow: hidden*/                                    /* Removed as this looks like a hack and combined with the position: relative in FB, which we need for the
                                                                   absolute positioning of the cell editors, this crops overlays, in particular the date picker */
    }
}

#fr-view .fr-grid .fr-grid-td .fr-grid-content img.xforms-input-input { *width: auto } // Undo effect of previous rule for image in minimal date picker

#fr-view .fr-grid-td .fr-grid-content .xforms-input input.xforms-type-date,
#fr-view .fr-grid-td .fr-grid-content .xforms-input input.xforms-type-time
    { *width: 6.3em }

/* Specify a width for the autocomplete text field so it doesn't that the whole width of the viewport on IE6/7.
   http://wiki.orbeon.com/forms/doc/contributor-guide/browser#TOC-Width-property-inside-an-absolutely */
#fr-view  .xbl-fr-autocomplete .fr-autocomplete-container .yui-ac .fr-autocomplete-search .xforms-input-input
    { *width: 13em }

// Show placeholder frame for buttons
.fr-buttons-placeholder { width: 100%; display: block; text-align: center }
.fr-buttons-placeholder div { margin: .5em }

// Custom control widths
#fr-view .fr-grid .fr-grid-content {
    .fr-width-2em   input.xforms-input-input, .fr-width-2em select   { width: 2em }
    .fr-width-3em   input.xforms-input-input, .fr-width-3em select   { width: 3em }
    .fr-width-4em   input.xforms-input-input, .fr-width-4em select   { width: 4em }
    .fr-width-5em   input.xforms-input-input, .fr-width-5em select   { width: 5em }
    .fr-width-7em   input.xforms-input-input, .fr-width-7em select   { width: 7em }
    .fr-width-10em  input.xforms-input-input, .fr-width-10em select  { width: 10em }
    .fr-width-12em  input.xforms-input-input, .fr-width-12em select  { width: 12em }
    .fr-width-15em  input.xforms-input-input, .fr-width-15em select  { width: 15em }
    .fr-width-100pc input.xforms-input-input, .fr-width-100pc select { width: 100% }

    .fr-width-2digits input.xforms-input-input, .fr-width-2digits select  { width: 2.2em }
    .fr-width-4digits input.xforms-input-input, .fr-width-4digits select  { width: 3.3em }
}

/* ***** View, PDF, email ******************************************************************************************* */

// Textarea in output mode can contain line breaks so try to keep them
pre.xforms-textarea, span.xforms-textarea pre { white-space: -moz-pre-wrap; white-space: pre-wrap; *white-space: normal }

.fr-mode-view .xforms-hint, .fr-mode-pdf .xforms-hint, .fr-mode-email .xforms-hint { display: none }
.fr-mode-view .xforms-alert, .fr-mode-pdf .xforms-alert, .fr-mode-email .xforms-alert { display: none }

.fr-mode-view .fr-section-title img,
  .fr-mode-pdf .fr-section-title img,
  .fr-mode-email .fr-section-title img { display: none }
.fr-mode-view .xforms-help-image,
  .fr-mode-pdf .xforms-help-image,
  .fr-mode-email .xforms-help-image { display: none }

// For those controls that still have a display: block in view mode, make sure there is no top margin
.fr-mode-view .fr-grid-content .xforms-control, .fr-mode-view .fr-grid-content .fr-component-group { margin-top: 0 }

// This is also used for PDF generation
@media print {
    // Don't hide as there is no script running
    html body form.xforms-initially-hidden { display: block }

    // There should not be a <style> element in the body, but if there is hide it for Flying Saucer
    style { display: none }

    // This must not show in the PDF
    noscript { display: none }

    form.xforms-form {
        .fr-status-icons { display: none }
        .xforms-loading-loading { display: none }
        // Upload remove button
        .xforms-upload-remove { display: none }
        // Remove background attachment image
        .xforms-upload-info { background: transparent none repeat scroll 0 0; padding-left: 2px }
        // Don't show download link
        .xbl-fr-attachment .xforms-output-appearance-xxforms-download { display: none }

        // Since only value is shown, no need for special height
        .fr-grid .xforms-select1-appearance-compact, .fr-grid .xforms-select-appearance-compact { height: auto }

        // Flying Saucer doesn't like display: block and 0 font sizes
        .clearfix:before, .clearfix:after,
        .row:before, .row:after,
        .row-fluid:before,
        .row-fluid:after,
        .container:before, .container:after,
        .container-fluid:before, .container-fluid:after,
        .dl-horizontal:before, .dl-horizontal:after,
        .controls-row:before, .controls-row:after,
        .form-actions:before, .form-actions:after,
        .form-horizontal .control-group:before,
        .form-horizontal .control-group:after,
        .nav-tabs:before, .nav-pills:before,
        .nav-tabs:after, .nav-pills:after,
        .tabbable:before, .tabbable:after,
        .navbar-inner:before, .navbar-inner:after,
        .navbar-form:before, .navbar-form:after,
        .pager:before, .pager:after,
        .modal-footer:before, .modal-footer:after,
        .thumbnails:before, .thumbnails:after,
        .navbar-inner:before, .navbar-inner:after {
            display: block;
        }

        .input-append, .input-prepend,
        .btn-group,
        .btn-toolbar {
            font-size: .5px;
        }
    }
}
