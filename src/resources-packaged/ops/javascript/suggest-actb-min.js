function actb(_1,ca,_3){var _4=_1;_4.actb_keywords=ca;_4.actb_no_filter=_3;_4.actb_timeOut=-1;_4.actb_lim=-1;_4.actb_firstText=true;_4.actb_mouse=true;_4.actb_delimiter=new Array();_4.actb_startcheck=0;_4.actb_bgColor="#fff";_4.actb_hColor="#36c";_4.actb_textColor="#000";_4.actb_hTextColor="#fff";_4.actb_fFamily="Arial,Helvetica,Geneva,sans-serif";_4.actb_fSize="9pt";_4.actb_hStyle="";var _5=_1.parentNode.id+"-tat_table";var _6=_1.parentNode.id+"-tat_tr";var _7=_1.parentNode.id+"-tat_td";var _8=new Array();var _9=0;var _a=new Array();var _b=false;var _c=0;var _d=0;var _e=_1;var _f=0;var _10=0;var _11=new Array();var _12=0;var _13;var _14=false;var _15="";var _16=1;var _17=0;var _18=false;addEvent(_e,"focus",actb_setup);function actb_setup(){addEvent(document,"keydown",actb_checkkey);addEvent(_e,"blur",actb_clear);addEvent(document,"keypress",actb_keypress);}function actb_clear(evt){if(!evt){evt=event;}removeEvent(document,"keydown",actb_checkkey);removeEvent(_e,"blur",actb_clear);removeEvent(document,"keypress",actb_keypress);setTimeout(actb_removedisp,100);}function actb_parse(n){if(_4.actb_delimiter.length>0){var t=_8[_9].trim().addslashes();var _1c=_8[_9].trim().length;}else{var t=_e.value.addslashes();var _1e=_e.value.length;}var _1f="";var i;if(_4.actb_no_filter){var re=new RegExp("");}else{if(_4.actb_firstText){var re=new RegExp("^"+t,"i");}else{var re=new RegExp(t,"i");}}var p=n.search(re);for(i=0;i<p;i++){_1f+=n.substr(i,1);}for(i=p;i<_1e+p;i++){_1f+=n.substr(i,1);}for(i=_1e+p;i<n.length;i++){_1f+=n.substr(i,1);}return _1f;}function actb_generate(){if(document.getElementById(_5)){_b=false;document.body.removeChild(document.getElementById(_5));}if(_17==0){_b=false;return;}a=document.createElement("table");a.cellSpacing="0px";a.cellPadding="0px";a.style.position="absolute";a.style.backgroundColor=_4.actb_bgColor;a.style.color=_4.actb_textColor;a.style.border="1px solid black";a.id=_5;document.body.appendChild(a);var i;var _26=true;var j=1;if(_4.actb_mouse){a.onmouseout=actb_table_unfocus;a.onmouseover=actb_table_focus;}var _28=0;for(i=0;i<_4.actb_keywords.length;i++){if(_11[i]){_28++;r=a.insertRow(-1);if(_26&&!_14){r.style.backgroundColor=_4.actb_hColor;r.style.color=_4.actb_hTextColor;_26=false;_c=_28;}else{if(_12==i){r.style.backgroundColor=_4.actb_hColor;r.style.color=_4.actb_hTextColor;_26=false;_c=_28;}else{r.style.backgroundColor=_4.actb_bgColor;r.style.color=_4.actb_textColor;}}r.id=_6+(j);c=r.insertCell(-1);c.style.fontFamily=_4.actb_fFamily;c.style.fontSize=_4.actb_fSize;c.style.padding="2px 2px 2px 2px";c.innerHTML=actb_parse(_4.actb_keywords[i]);c.id=_7+(j);c.setAttribute("pos",j);if(_4.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouseclick;c.onmouseover=actb_table_highlight;}j++;}if(j-1==_4.actb_lim&&j<_d){r=a.insertRow(-1);r.style.backgroundColor=_4.actb_bgColor;r.style.color=_4.actb_textColor;c=r.insertCell(-1);c.style.fontFamily="arial narrow";c.style.fontSize=_4.actb_fSize;c.align="center";replaceHTML(c,"\\/");if(_4.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_down;}break;}}if(a.offsetWidth<_4.offsetWidth){a.width=_4.offsetWidth;}var _29=YAHOO.util.Dom.getXY(_e);_29[1]+=_e.offsetHeight;YAHOO.util.Dom.setXY(a,_29);_f=1;_10=j-1;_b=true;if(_c<=0){_c=1;}}function actb_remake(){document.body.removeChild(document.getElementById(_5));a=document.createElement("table");a.cellSpacing="1px";a.cellPadding="2px";a.style.position="absolute";a.style.top=eval(curTop(_e)+_e.offsetHeight)+"px";a.style.left=curLeft(_e)+"px";a.style.backgroundColor=_4.actb_bgColor;a.style.color=_4.actb_textColor;a.id=_5;if(_4.actb_mouse){a.onmouseout=actb_table_unfocus;a.onmouseover=actb_table_focus;}document.body.appendChild(a);var i;var _2b=true;var j=1;if(_f>1){r=a.insertRow(-1);r.style.backgroundColor=_4.actb_bgColor;r.style.color=_4.actb_textColor;c=r.insertCell(-1);c.style.fontFamily="arial narrow";c.style.fontSize=_4.actb_fSize;c.align="center";replaceHTML(c,"/\\");if(_4.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_up;}}for(i=0;i<_4.actb_keywords.length;i++){if(_11[i]){if(j>=_f&&j<=_10){r=a.insertRow(-1);r.style.backgroundColor=_4.actb_bgColor;r.style.color=_4.actb_textColor;r.id=_6+(j);c=r.insertCell(-1);c.style.fontFamily=_4.actb_fFamily;c.style.fontSize=_4.actb_fSize;c.innerHTML=actb_parse(_4.actb_keywords[i]);c.id=_7+(j);c.setAttribute("pos",j);if(_4.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouseclick;c.onmouseover=actb_table_highlight;}j++;}else{j++;}}if(j>_10){break;}}if(j-1<_d){r=a.insertRow(-1);r.style.backgroundColor=_4.actb_bgColor;r.style.color=_4.actb_textColor;c=r.insertCell(-1);c.style.fontFamily="arial narrow";c.style.fontSize=_4.actb_fSize;c.align="center";replaceHTML(c,"\\/");if(_4.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_down;}}}function actb_goup(){if(!_b){return;}if(_c==1){return;}document.getElementById(_6+_c).style.backgroundColor=_4.actb_bgColor;document.getElementById(_6+_c).style.color=_4.actb_textColor;_c--;if(_c<_f){actb_moveup();}document.getElementById(_6+_c).style.backgroundColor=_4.actb_hColor;document.getElementById(_6+_c).style.color=_4.actb_hTextColor;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_godown(){if(!_b){actb_tocomplete(40);return;}if(_c==_d){return;}document.getElementById(_6+_c).style.backgroundColor=_4.actb_bgColor;document.getElementById(_6+_c).style.color=_4.actb_textColor;_c++;if(_c>_10){actb_movedown();}document.getElementById(_6+_c).style.backgroundColor=_4.actb_hColor;document.getElementById(_6+_c).style.color=_4.actb_hTextColor;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_movedown(){_f++;_10++;actb_remake();}function actb_moveup(){_f--;_10--;actb_remake();}function actb_mouse_down(){document.getElementById(_6+_c).style.backgroundColor=_4.actb_bgColor;document.getElementById(_6+_c).style.color=_4.actb_textColor;_c++;actb_movedown();document.getElementById(_6+_c).style.backgroundColor=_4.actb_hColor;document.getElementById(_6+_c).style.color=_4.actb_hTextColor;_e.focus();_16=0;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_mouse_up(evt){if(!evt){evt=event;}if(evt.stopPropagation){evt.stopPropagation();}else{evt.cancelBubble=true;}document.getElementById(_6+_c).style.backgroundColor=_4.actb_bgColor;document.getElementById(_6+_c).style.color=_4.actb_textColor;_c--;actb_moveup();document.getElementById(_6+_c).style.backgroundColor=_4.actb_hColor;document.getElementById(_6+_c).style.color=_4.actb_hTextColor;_e.focus();_16=0;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_mouseclick(evt){if(!evt){evt=event;}if(!_b){return;}_16=0;_c=this.getAttribute("pos");actb_penter();xformsHandleAutoCompleteMouseChange(_4);}function actb_table_focus(){_16=1;}function actb_table_unfocus(){_16=0;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_table_highlight(){_16=1;document.getElementById(_6+_c).style.backgroundColor=_4.actb_bgColor;document.getElementById(_6+_c).style.color=_4.actb_textColor;_c=this.getAttribute("pos");while(_c<_f){actb_moveup();}while(_c>_10){actb_movedown();}document.getElementById(_6+_c).style.backgroundColor=_4.actb_hColor;document.getElementById(_6+_c).style.color=_4.actb_hTextColor;if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}}function actb_insertword(a){if(_4.actb_delimiter.length>0){str="";l=0;for(i=0;i<_8.length;i++){if(_9==i){prespace=postspace="";gotbreak=false;for(j=0;j<_8[i].length;++j){if(_8[i].charAt(j)!=" "){gotbreak=true;break;}prespace+=" ";}for(j=_8[i].length-1;j>=0;--j){if(_8[i].charAt(j)!=" "){break;}postspace+=" ";}str+=prespace;str+=a;l=str.length;if(gotbreak){str+=postspace;}}else{str+=_8[i];}if(i!=_8.length-1){str+=_a[i];}}_e.value=str;setCaret(_e,l);}else{_e.value=a;}_16=0;actb_removedisp();}function actb_penter(){if(!_b){return;}_b=false;var _30="";var c=0;for(var i=0;i<=_4.actb_keywords.length;i++){if(_11[i]){c++;}if(c==_c){_30=_4.actb_keywords[i];break;}}actb_insertword(_30);l=getCaretStart(_e);}function actb_removedisp(){if(true||_16==0){_b=0;if(document.getElementById(_5)){document.body.removeChild(document.getElementById(_5));}if(_13){clearTimeout(_13);}}}function actb_keypress(e){if(_18){stopEvent(e);}return !_18;}function actb_checkkey(evt){if(!evt){evt=event;}a=evt.keyCode;caret_pos_start=getCaretStart(_e);_18=0;switch(a){case 38:actb_goup();_18=1;return false;break;case 40:actb_godown();_18=1;return false;break;case 13:case 9:if(_b){_18=1;actb_penter();return false;}else{return true;}break;default:setTimeout(function(){actb_tocomplete(a);},50);break;}}function actb_tocomplete(kc){if(kc==27||kc==37||kc==39||kc==9){actb_removedisp();return;}if(kc==38||kc==13||kc==18||kc==16||kc==17||kc==20){return;}var i;if(_b){var _37=0;var c=0;for(var i=0;i<=_4.actb_keywords.length;i++){if(_11[i]){c++;}if(c==_c){_37=i;break;}}_12=_37;}else{_12=-1;}if(_e.value==""&&kc!=40){_16=0;actb_removedisp();return;}if(_4.actb_delimiter.length>0){caret_pos_start=getCaretStart(_e);caret_pos_end=getCaretEnd(_e);delim_split="";for(i=0;i<_4.actb_delimiter.length;i++){delim_split+=_4.actb_delimiter[i];}delim_split=delim_split.addslashes();delim_split_rx=new RegExp("(["+delim_split+"])");c=0;_8=new Array();_8[0]="";for(i=0,j=_e.value.length;i<_e.value.length;i++,j--){if(_e.value.substr(i,j).search(delim_split_rx)==0){ma=_e.value.substr(i,j).match(delim_split_rx);_a[c]=ma[1];c++;_8[c]="";}else{_8[c]+=_e.value.charAt(i);}}var l=0;_9=-1;for(i=0;i<_8.length;i++){if(caret_pos_end>=l&&caret_pos_end<=l+_8[i].length){_9=i;}l+=_8[i].length+1;}var ot=_8[_9].trim();var t=_8[_9].addslashes().trim();}else{var ot=_e.value;var t=_e.value.addslashes();}if(ot.length==0&&kc!=40){_16=0;actb_removedisp();}if(ot.length<_4.actb_startcheck){return this;}if(_4.actb_no_filter){var re=new RegExp("");}else{if(_4.actb_firstText){var re=new RegExp("^"+t,"i");}else{var re=new RegExp(t,"i");}}_d=0;_14=false;_17=0;for(i=0;i<_4.actb_keywords.length;i++){_11[i]=false;if(re.test(_4.actb_keywords[i])){_d++;_11[i]=true;_17++;if(_12==i){_14=true;}}}if(_13){clearTimeout(_13);}if(_4.actb_timeOut>0){_13=setTimeout(function(){_16=0;actb_removedisp();},_4.actb_timeOut);}actb_generate();}return actb_tocomplete;}