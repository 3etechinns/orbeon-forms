<!--
    Copyright (C) 2004 Orbeon, Inc.
  
    This program is free software; you can redistribute it and/or modify it under the terms of the
    GNU Lesser General Public License as published by the Free Software Foundation; either version
    2.1 of the License, or (at your option) any later version.
  
    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU Lesser General Public License for more details.
  
    The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
-->
<example-descriptor xmlns:f="http://orbeon.org/oxf/xml/formatting">
    <title>Accessing the Session</title>
    <xi:include href="example-descriptor-files.xml" xmlns:xi="http://www.w3.org/2003/XInclude"/>
    <description >
        <div xmlns="http://www.w3.org/1999/xhtml">
            <p>
                This example illustrates the use of the Scope generator and Scope serializer. The <a
                href="/doc/processors-generators#ContextGenerator" f:url-type="resource">Scope
                generator</a> retrieves an XML Document from a Request, Session or Application
                contex. The <a href="/doc/processors-serializers#ContextSerializer"
                f:url-type="resource">Scope serializer</a> stores an XML document to a Request,
                Session or Application context. This example uses these processors to implement a
                simple shopping cart that allows you to add text lines to the session and clear
                them. Here is an illustration of XML document stored in the session:
                <f:xml-source>
                    <cart>
                        <item>First</item>
                        <item>Second</item>
                        <item>Third</item>
                    </cart>
                </f:xml-source>
            </p>
            <p>
                The following files are involved:
            </p>
            <ul>
                <p>
                    <li>
                        <a href="/goto-source/cart/get.xpl" f:url-type="resource">get.xpl</a>. This
                        XPL pipeline is executed upon accessing the <code>/direct/cart/get</code>
                        path. A Scope generator retrieves the XML document stored under the
                        <code>cart</code> key.
                    </li>
                </p>

                <p>
                    <li>
                        <a href="/goto-source/cart/add.xpl" f:url-type="resource">add.xpl</a>. This
                        XPL pipeline is executed upon accessing the <code>/direct/cart/add</code>
                        path. The document currently stored in the session is copied, and the new
                        value is added to the document. Finally, the Scope serializer stores the
                        resulting document in the session.
                    </li>
                </p>

                <p>
                    <li>
                        <a href="/goto-source/cart/clear.xpl" f:url-type="resource">clear.xpl</a>.
                        This XPL pipeline is executed upon accessing the
                        <code>/direct/cart/clear</code> path. The document currently stored in the
                        session is emptied, leaving only a root element.
                    </li>
                </p>

                <p>
                    <li>
                        <a href="/goto-source/cart/view.xhtml" f:url-type="resource">view.xhtml</a>.
                        The page view is implemented with XForms and is in charge of performing
                        various XForms submissions to the paths above. It uses
                        <code>xforms:repeat</code> to iterate through cart entries and display them.
                    </li>
                </p>
            </ul>
        </div>
    </description>
</example-descriptor>
