<!--
    Copyright (C) 2004 Orbeon, Inc.
  
    This program is free software; you can redistribute it and/or modify it under the terms of the
    GNU Lesser General Public License as published by the Free Software Foundation; either version
    2.1 of the License, or (at your option) any later version.
  
    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU Lesser General Public License for more details.
  
    The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
-->
<xforms:model xmlns:xforms="http://www.w3.org/2002/xforms">
    <xforms:instance>
        <form>
            <action/>
            <message>
                <smtp-host/>
                <from>
                    <email/>
                    <name/>
                </from>
                <to>
                    <email/>
                    <name/>
                </to>
                <cc>
                    <email/>
                    <name/>
                </cc>
                <subject/>
                <body mime-multipart="alternative">
                    <!-- Provide simple text alternative -->
                    <part name="text" content-type="text/plain">Your email client does not support displaying HTML messages.</part>
                    <!-- HTML alternative -->
                    <part name="html" content-type="multipart/related">
                        <part name="main" content-type="text/html">
                            <html>
                                <head>
                                    <title/>
                                </head>
                                <body>
                                    <p>
                                        This is text entered in Presentation Server's Email example form:
                                    </p>
                                    <p style="border: dotted 1px gray; padding: 5px">Orbeon Presentation Server is a J2EE-based MVC framework for building Web applications that present and capture XML using XForms, XSLT, and Web Services. Presentation Server benefits from standardized forms processing using XForms, rich controller semantics, and full-featured XML pipelines. Presentation Server is in fact built around Orbeon's optimized XML pipeline engine, a mature, high-performance engine for pipeline processing of XML. Presentation Server is ideal for building Composite Applications in a Service Oriented Architecture (SOA), an can be used on its own, or within the OIS suite.</p>
                                    <p>
                                        This is a static image attached to the email and referred to by the HTML version:
                                    </p>
                                    <div style="border: dotted 1px gray; padding: 5px">
                                        <img src="cid:id1"/>
                                    </div>
                                    <p>
                                        This is an dynamic chart image attached to the email and referred to by the HTML version:
                                    </p>
                                    <div style="border: dotted 1px gray; padding: 5px">
                                        <img src="cid:id2"/>
                                    </div>
                                </body>
                            </html>
                        </part>
                        <!-- Attachments -->
                        <part name="image" content-type="image/gif" content-disposition="inline; filename=&quot;logo.gif&quot;" content-id="id1" src="oxf:/oxf-theme/images/oxf-powered-80.gif"/>
                        <part name="pdf" content-type="application/pdf" content-disposition="inline; filename=&quot;report.pdf&quot;" src="input:pdf-document"/>
                        <part name="chart" content-type="image/png" content-disposition="inline; filename=&quot;chart.png&quot;" content-id="id2" src="input:png-document"/>
                        <part name="xforms" content-type="application/xml" content-disposition="inline; filename=&quot;instance.xml&quot;" src="input:xforms-instance"/>
                    </part>
                </body>
            </message>
        </form>
    </xforms:instance>
    <!-- Constraints -->
    <xforms:bind nodeset="/form/message/smtp-host" constraint="normalize-space(.) != ''"/>
    <xforms:bind nodeset="/form/message/from/email" constraint="normalize-space(.) != ''"/>
    <xforms:bind nodeset="/form/message/to/email" constraint="normalize-space(.) != ''"/>
    <xforms:bind nodeset="/form/message/subject" constraint="normalize-space(.) != ''"/>
    <xforms:bind nodeset="/form/message/body/part[2]/part/html/body/p[2]" constraint="normalize-space(.) != ''"/>
    <!-- Calculation to create the plain text version and HTML title -->
    <xforms:bind nodeset="/form/message/body/part[1]" calculate="string(/form/message/body/part[2]/part/html/body/p[1])"/>
    <xforms:bind nodeset="/form/message/body/part[2]/part/html/head/title" calculate="string(/form/message/subject)"/>
    <!-- Mark irrelevant nodes (to support optional fields) -->
    <xforms:bind nodeset="/form/message/cc" relevant="normalize-space(/form/message/cc/email) != ''"/>
</xforms:model>
