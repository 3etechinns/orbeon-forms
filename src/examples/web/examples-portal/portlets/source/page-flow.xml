<!--
    Copyright (C) 2005 Orbeon, Inc.
  
    This program is free software; you can redistribute it and/or modify it under the terms of the
    GNU Lesser General Public License as published by the Free Software Foundation; either version
    2.1 of the License, or (at your option) any later version.
  
    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
    without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU Lesser General Public License for more details.
  
    The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
-->
<config xmlns="http://www.orbeon.com/oxf/controller"
        xmlns:oxf="http://www.orbeon.com/oxf/processors"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- Display the source for an individual file -->
    <page id="detail" path-info="/([^/]+)/(.+)" matcher="oxf:perl5-matcher"
            default-submission="detail/default-submission.xml"
            model="detail/detail-model.xpl"
            view="detail/detail-view.xsl">
        <setvalue ref="/form/example-id" matcher-group="1"/>
        <setvalue ref="/form/source-url" matcher-group="2"/>
        <action when="/form/action = 'back'">
            <result page="summary" transform="oxf:xslt">
                <form xmlns="" xsl:version="2.0">
                    <xsl:copy-of select="/*/example-id"/>
                    <source-url/>
                </form>
            </result>
        </action>
    </page>

    <!-- Produce the list of source files -->
    <page id="summary" path-info="/(.+)" matcher="oxf:perl5-matcher"
            default-submission="summary/default-submission.xml"
            model="summary/summary-model.xpl"
            view="summary/summary-view.xsl">
        <setvalue ref="/form/example-id" matcher-group="1"/>
        <action when="/form/source-url != ''">
            <result page="detail" transform="oxf:xslt">
                <form xmlns="" xsl:version="2.0">
                    <action/>
                    <xsl:copy-of select="/*/(example-id | source-url)"/>
                </form>
            </result>
        </action>
    </page>

    <epilogue url="oxf:/config/epilogue.xpl"/>

</config>
